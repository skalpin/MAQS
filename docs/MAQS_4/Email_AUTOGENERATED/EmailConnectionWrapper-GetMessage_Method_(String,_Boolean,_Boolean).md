# EmailConnectionWrapper.GetMessage Method (String, Boolean, Boolean)
 

Get an email message from the current mailbox

**Namespace:**&nbsp;<a href="#/MAQS_4/Email_AUTOGENERATED/Magenic-MaqsFramework-BaseEmailTest_Namespace">Magenic.MaqsFramework.BaseEmailTest</a><br />**Assembly:**&nbsp;Magenic.MaqsFramework.BaseEmailTest (in Magenic.MaqsFramework.BaseEmailTest.dll) Version: 4.0.4.0 (4.0.4)

## Syntax

**C#**<br />
``` C#
public virtual MimeMessage GetMessage(
	string uid,
	bool headerOnly = false,
	bool markRead = false
)
```


#### Parameters
&nbsp;<dl><dt>uid</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System.String</a><br />The unique identifier for the email</dd><dt>headerOnly (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">System.Boolean</a><br />Only get header data</dd><dt>markRead (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">System.Boolean</a><br />Mark the email as read</dd></dl>

#### Return Value
Type: MimeMessage<br />The message

## Examples

**C#**<br />
``` C#
[TestMethod]
[TestCategory(TestCategories.Email)]
public void GetSpecificMessage()
{
    this.EmailWrapper.SelectMailbox("Test/SubTest");
    MimeMessage singleMessage = this.EmailWrapper.GetMessage("3");
    Assert.AreEqual("Plain Text", singleMessage.Subject);
    Assert.IsFalse(string.IsNullOrEmpty(singleMessage.Body.ToString()), "Expected to go the message body");
}
```

**C#**<br />
``` C#
[TestMethod]
[TestCategory(TestCategories.Email)]
public void GetSpecificMessageHeader()
{
    this.EmailWrapper.SelectMailbox("Test/SubTest");
    MimeMessage singleMessage = this.EmailWrapper.GetMessage("3", true);
    Assert.AreEqual("Plain Text", singleMessage.Subject);
    Assert.IsNull(singleMessage.Body, "Expected not to go the message body");
}
```


## See Also


#### Reference
<a href="#/MAQS_4/Email_AUTOGENERATED/EmailConnectionWrapper_Class">EmailConnectionWrapper Class</a><br /><a href="#/MAQS_4/Email_AUTOGENERATED/EmailConnectionWrapper-GetMessage_Method">GetMessage Overload</a><br /><a href="#/MAQS_4/Email_AUTOGENERATED/Magenic-MaqsFramework-BaseEmailTest_Namespace">Magenic.MaqsFramework.BaseEmailTest Namespace</a><br />